# Kagenti Agent with Kata Runtime (VM Isolation)
# This Agent runs inside a micro-VM for execution isolation
apiVersion: agent.kagenti.dev/v1alpha1
kind: Agent
metadata:
  name: adk-kata-agent
  namespace: agent-sandbox
spec:
  server:
    name: simple-adk-agent
    endpoint: /mcp
  image: quay.io/rbrhssa/simple-adk-agent:latest
  imagePullSecrets:
    - name: quay-pull-secret
  podTemplateSpec:
    spec:
      runtimeClassName: kata  # VM isolation via Kata Containers
      containers:
        - name: agent
          resources:
            limits:
              memory: "2Gi"    # Required for QEMU overhead
              cpu: "1"
            requests:
              memory: "2Gi"
              cpu: "500m"
          env:
            - name: HOME
              value: /tmp
          volumeMounts:
            - name: tmp
              mountPath: /tmp
            - name: adk-cache
              mountPath: /app/.adk
      volumes:
        - name: tmp
          emptyDir: {}
        - name: adk-cache
          emptyDir: {}
